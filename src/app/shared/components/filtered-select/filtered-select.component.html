<mat-select
  class="select"
  [formControl]="selectControl"
  (openedChange)="filterInput.focus()"
  (selectionChange)="onSelectionChange()"
  [multiple]="multiple">
  <mat-form-field
    class="select__field"
    subscriptSizing="dynamic"
    appearance="fill"
    color="primary">
    <input
      class="select__search-input"
      #filterInput
      [formControl]="filterControl"
      matInput
      [placeholder]="'filtered_select.placeholder' | translate" />
  </mat-form-field>

  <div *ngIf="multiple">
    <mat-checkbox
      class="select__select-all-checkbox"
      [checked]="allOptionsSelected"
      [indeterminate]="!noneOptionsSelected && !allOptionsSelected"
      (change)="selectAllOptions($event.checked)">
      {{
        (allOptionsSelected
          ? 'filtered_select.checkbox_unselect_all'
          : 'filtered_select.checkbox_select_all'
        ) | translate
      }}
    </mat-checkbox>
  </div>

  <div class="select__options-container">
    <mat-option class="select__option" *ngIf="!multiple"> -- </mat-option>
    <ng-container *ngIf="!isLoading">
      <mat-option
        class="select__option"
        *ngFor="let option of filteredSelectOptions"
        [value]="option.value">
        {{ option.name }}
      </mat-option>
    </ng-container>
    <div class="loading" *ngIf="isLoading">
      <mat-progress-bar mode="query"></mat-progress-bar>
    </div>
  </div>
</mat-select>
